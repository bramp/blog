<!DOCTYPE html>
<html lang=en>
<head itemscope itemtype=http://schema.org/WebSite>
<meta charset=utf-8>
<meta content="width=device-width,initial-scale=1" name=viewport>
<link href=https://blog.bramp.net/post/2017/10/02/vanity-go-import-paths/ rel=canonical itemprop=url />
<title>Vanity Go Import Paths</title>
<meta content="When using third-party packages in Go, they are imported by a path that represents how to download that package from the Internet. For example, to use the popular structured logging library, Logrus, …" name=description itemprop=description>
<meta content="Andrew Brampton" name=author itemprop=creator>
<meta content="" name=generator />
<link href=https://blog.bramp.net/index.xml rel=alternate type=application/rss+xml title=bramp.net />
<link href=https://blog.bramp.net/index.xml rel=feed type=application/rss+xml title=bramp.net />
<meta content=#4582EC name=theme-color>
<link href=/favicon.ico rel="shortcut icon" type=image/x-icon />
<link href=/images/favicon.png rel=apple-touch-icon />
<link href=/images/favicon-57x57.png rel=apple-touch-icon sizes=57x57 />
<link href=/images/favicon-72x72.png rel=apple-touch-icon sizes=72x72 />
<link href=/images/favicon-76x76.png rel=apple-touch-icon sizes=76x76 />
<link href=/images/favicon-114x114.png rel=apple-touch-icon sizes=114x114 />
<link href=/images/favicon-120x120.png rel=apple-touch-icon sizes=120x120 />
<link href=/images/favicon-144x144.png rel=apple-touch-icon sizes=144x144 />
<link href=/images/favicon-152x152.png rel=apple-touch-icon sizes=152x152 />
<link href=/images/favicon-180x180.png rel=apple-touch-icon sizes=180x180 />
<meta content=#4582EC name=msapplication-TileColor>
<meta content=/images/favicon-144x144.png name=msapplication-TileImage>
<link href=/images/favicon-192x192.png rel=icon sizes=192x192 />
<link href=/css/all.830a48cea183bb2cd4a5c281b2aa5573.min.css rel=stylesheet>
<link href=/css/sortable-theme-minimal.css rel=stylesheet />
<link href=https://cdn.jsdelivr.net/font-hack/2.010/css/hack.min.css rel=stylesheet>
<script src="https://www.googletagmanager.com/gtag/js?id=UA-136478-5" async></script>
<script>
window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-136478-5');
</script>
<meta content=summary name=twitter:card />
<meta content=@TheBramp name=twitter:site />
<meta content=@TheBramp name=twitter:creator />
<meta content=article property=og:type />
<meta content=https://www.facebook.com/bramp property=article:author />
<meta content=2017-10-02T07:48:23&#43;07:00 property=article:published_time />
<meta content=Go property=article:tag />
<meta content=Goredirects property=article:tag />
<meta content=GitHub property=article:tag />
<meta content=https://blog.bramp.net/post/2017/10/02/vanity-go-import-paths/ property=og:url />
<meta content=bramp.net property=og:site_name />
<meta content="Vanity Go Import Paths" property=og:title />
<meta content="When using third-party packages in Go, they are imported by a path that represents how to download that package from the Internet. For example, to use the popular structured logging library, Logrus, …" property=og:description />
<meta content=2017-10-02T07:48:23-07:00 property=og:updated_time />
<meta content=en_GB property=og:locale />
<meta content=RXqIC-7spNUYReoHFlubz8Fbqsg1fC1pE6FSgSnCNjQ name=google-site-verification />
</head>
<body itemscope itemtype=Blog>
<div id=wrapper>
<nav class="navbar navbar-default">
<div class=container>
<div class=navbar-header>
<button class=navbar-toggle data-target=.navbar-collapse data-toggle=collapse type=button>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<div class=navbar-brand aria-label="About Andrew Brampton">
<a href=/ >
<img alt=Home class=profile-image height=64 src=/images/favicon-64x64.png width=64>
</a>
<div itemprop=author itemscope itemtype=https://schema.org/Person>
<a href=/about-me/ itemprop=name>Andrew Brampton</a>
<div id=social-wrapper>
<a href=https://twitter.com/TheBramp aria-label=Twitter><svg class="icon icon-twitter-square"><use xlink:href=/images/icons.svg#icon-twitter-square></use></svg></a>
<a href=https://www.linkedin.com/in/bramp aria-label=LinkedIn><svg class="icon icon-linkedin-square"><use xlink:href=/images/icons.svg#icon-linkedin-square></use></svg></a>
<a href=https://www.facebook.com/bramp aria-label=Facebook><svg class="icon icon-facebook-square"><use xlink:href=/images/icons.svg#icon-facebook-square></use></svg></a>
<a href=https://github.com/bramp aria-label=GitHub><svg class="icon icon-github-square"><use xlink:href=/images/icons.svg#icon-github-square></use></svg></a>
<a href=https://feeds.feedburner.com/brampnet aria-label="RSS feed"><svg class="icon icon-github-square"><use xlink:href=/images/icons.svg#icon-rss-square></use></svg></a>
</div>
</div>
</div>
</div>
<div class="collapse navbar-collapse">
<ul class="nav navbar-nav" role=navigation>
<li><a href=/ >Articles</a></li>
<li><a href=/about-me/ >About Me</a></li>
<li><a href=/android-app/ >Android Apps</a></li>
<li><a href=/opensource/ >Open Source</a></li>
<li><a href=/publication/ >Publications</a></li>
</ul>
</div>
</div>
</nav>
<div class="container main">
<main>
<article id=article itemProp=blogPost itemscope itemtype=http://schema.org/BlogPosting>
<h1 itemprop=headline>Vanity Go Import Paths</h1>
<p class=meta>
<svg class="icon icon-calendar"><use xlink:href=/images/icons.svg#icon-calendar></use></svg> <time itemprop=datePublished>2017-10-02</time>
| <a href=https://blog.bramp.net/tags/go/ >Go</a>
| <a href=https://blog.bramp.net/tags/goredirects/ >Goredirects</a>
| <a href=https://blog.bramp.net/tags/github/ >GitHub</a>
</p>
<div class=post itemprop=articleBody>
<p>When using third-party packages in Go, they are imported by a path that represents how to download that package from the Internet. For example, to use the popular structured logging library, <a href=https://github.com/sirupsen/logrus>Logrus</a>, it would imported at the top of the Go program like so:</p>
<div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kn>import</span> <span class=p>(</span>
  <span class=s>&#34;github.com/sirupsen/logrus&#34;</span>
<span class=p>)</span>
</code></pre></div><p>When <code>go get</code> is then executed, it fetches the Logrus source code from GitHub and places the code in the <code>$GOPATH/src</code> directory. Take a look for yourself:</p>
<div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ tree <span class=nv>$GOPATH</span>/src
...
├── github.com
│   ├── Sirupsen
│   │   └── logrus
...
</code></pre></div><p>An astute reader may wonder, how exactly does <code>go get</code> know that <code>github.com/sirupsen/logrus</code> is a Git repository, and that it can be fetched via the git protocol from that URL. The <code>go get</code> binary could have some smarts in it, that knows about GitHub, and does the right thing. But that seems inflexible, and problematic if new sites want to be supported. Instead the Go developers built a layer of indirection that allows the <code>go get</code> tool to discover the correct source repo.</p>
<p>As outlined in the <a href=https://golang.org/cmd/go/#hdr-Remote_import_paths>Remote Import Paths</a> docs, the <code>go get</code> binary will make a normal HTTP request to <code>https://github.com/sirupsen/logrus</code> (falling back to http if needed) and look at the returned HTML for a <code>&lt;meta name=&quot;go-import&quot;</code> tag. This meta tag, can then redirect the <code>go get</code> binary to the correct source code repository for the package.</p>
<p>This meta tag can been seen with <code>curl</code>:</p>
<div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ curl https://github.com/sirupsen/logrus <span class=p>|</span> grep meta <span class=p>|</span> grep go-import
</code></pre></div><div class=highlight><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>&#34;go-import&#34;</span>
  <span class=na>content</span><span class=o>=</span><span class=s>&#34;github.com/sirupsen/logrus git https://github.com/sirupsen/logrus.git&#34;</span><span class=p>&gt;</span>
</code></pre></div><p>That tag says, the package rooted at <code>github.com/sirupsen/logrus</code> can be fetched with git, at the URL <code>https://github.com/sirupsen/logrus.git</code>. The meta tag can express other source control systems, e.g Mercurial, Bazaar, Subversion.</p>
<p>GitHub is a very convenient place to host source code, but the GitHub URL is generic. Instead it is possible to use the <code>&lt;meta&gt;</code> tag to create vanity domains to host projects. For example, the package hosted at <a href=https://github.com/bramp/goredirects>github.com/bramp/goredirects</a> could instead be imported as <code>bramp.net/goredirects</code>. All that is needed is a static HTML page at <code>bramp.net/goredirects</code>, containing the following <code>&lt;meta&gt;</code> tag pointing at GitHub.</p>
<div class=highlight><pre class=chroma><code class=language-html data-lang=html><span class=p>&lt;</span><span class=nt>meta</span> <span class=na>name</span><span class=o>=</span><span class=s>go-import</span>
  <span class=na>content</span><span class=o>=</span><span class=s>&#34;bramp.net/goredirects git https://github.com/bramp/goredirects.git&#34;</span><span class=p>&gt;</span>
</code></pre></div><p>Incase a user attempted to visit that page directly with their web browser, it is worthwhile placing more information about the project on the page, or simply making the page redirect.</p>
<p>To help make these redirect pages, I wrote a simple go tool, <a href=https://github.com/bramp/goredirects><code>goredirects</code></a>, that inspects all local repositories under a vanity domain directory in the local <code>$GOPATH/src/</code> and outputs static HTML pages that can be hosted on that domain.</p>
<p>For example, create your new project on GitHub, but check out the project under <code>$GOPATH/src/example.com/project</code>. Then run the tool:</p>
<div class=highlight><pre class=chroma><code class=language-bash data-lang=bash>$ go install bramp.net/goredirects
$ goredirects example.com outputdir
</code></pre></div><p>The directory <code>outputdir</code> will now contain multiple directories and html files, one for each project under <code>$GOPATH/src/example.com</code>. These HTML files contain the appropriate goimports meta tag to redirect the download of source code from the vanity name, to GitHub. Just upload these files to your website, voilà you are done. Examples of these vanity redirect files can be found on bramp.net, e.g <a href=https://bramp.net/goredirects/index.html>bramp.net/goredirects/index.html</a>. This tool even works for packages with sub-packages under the main root.</p>
<p>Finally, it is possible to ensure that if someone finds your project via GitHub, that <code>go get</code> will always place it under your vanity domain. This be can be achieved with an <a href=https://golang.org/cmd/go/#hdr-Import_path_checking>import comment</a>. Within the source code, ensure that at least one of the files in your page has a comment like so:</p>
<div class=highlight><pre class=chroma><code class=language-go data-lang=go><span class=kn>package</span> <span class=nx>project</span> <span class=c1>// import &#34;example.com/project&#34;
</span></code></pre></div><p>Then <code>go get</code> will enforce the correct/vanity URL to use, instead of the true location.</p>
<p>More helpful links on the topic:</p>
<ul>
<li><a href=https://golang.org/cmd/go/#hdr-Import_path_checking>golang.org/cmd/go/#hdr-Import_path_checking</a></li>
<li><a href=https://golang.org/cmd/go/#hdr-Remote_import_paths>golang.org/cmd/go/#hdr-Remote_import_paths</a></li>
<li><a href=https://golang.org/doc/go1.4#canonicalimports>golang.org/doc/go1.4#canonicalimports</a></li>
<li><a href=https://godoc.org/golang.org/x/tools/cmd/fiximports>godoc.org/golang.org/x/tools/cmd/fiximports</a></li>
<li><a href=https://texlution.com/post/golang-canonical-import-paths/ >texlution.com/post/golang-canonical-import-paths/</a></li>
</ul>
</div>
</article>
<div class=row>
<div class=col-sm-6>
<div class=addthis_sharing_toolbox></div>
</div>
<div class=col-sm-6>
<div class=btn-toolbar>
<div class=btn-group>
<a href=https://feeds.feedburner.com/brampnet aria-label="RSS feed" class="btn btn-sm btn-soundcloud"><svg class="icon icon-rss"><use xlink:href=/images/icons.svg#icon-rss></use></svg> Subscribe via RSS</a>
</div>
<div class=btn-group>
<a href=https://twitter.com/TheBramp class="btn btn-sm btn-twitter"><svg class="icon icon-twitter"><use xlink:href=/images/icons.svg#icon-twitter></use></svg> Follow @TheBramp</a>
</div>
</div>
</div>
</div>
<ul class=pager>
&nbsp;<li class=previous><a href=/post/2017/07/15/teaching-binary-to-8th-graders/ >&larr; Teaching Binary to 8th Graders</a></li>
&nbsp;<li class=next><a href=/post/2017/12/16/parsing-with-antlr4-and-go/ >Parsing with Antlr4 and Go &rarr;</a></li>
</ul>
<div id=disqus_thread itemprop=comment itemscope itemtype=Comment></div>
<script type=text/javascript>
var disqus_identifier = 'https:\/\/blog.bramp.net\/post\/2017\/10\/02\/vanity-go-import-paths\/';
    var disqus_title = 'Vanity Go Import Paths';
    var disqus_url = 'https:\/\/blog.bramp.net\/post\/2017\/10\/02\/vanity-go-import-paths\/';
    (function() {
	    
	    
	    if (window.location.host.lastIndexOf(":1313") >= 0 || ["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
	        return;
        }

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + "bramp" + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</main>
<br/>
<footer>
<p class="credit text-muted">&copy; 2021. All rights reserved.</p>
</footer>
</div>
</div>
<script src=/js/all.421bdc0798a792d922b399e8180168e3.min.js></script>
<script src=/js/sortable.min.js></script>
<script src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=ra-559846a374d7ecaa" async type=text/javascript></script>
</body>
</html>
