<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Ordnance Survey Easting/Northing to Lat/Long</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo"/>
  <link href="" rel="alternate" type="application/rss+xml" title="bramp.net" />
  <link href="http://bramp.net/blog/css/bootstrap.min.css" rel="stylesheet">
  <link href="http://bramp.net/blog/css/bramp.css" rel="stylesheet">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  
  
    
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-136478-5', 'auto');
    ga('send', 'pageview');
  </script>
  
</head>
<body>

<div id = "wrapper">

  <div class="navbar navbar-default" role="navigation">
      <div class="container">

        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <div class="navbar-brand">
            <a href="http://bramp.net/blog">
              <img src="//secure.gravatar.com/avatar/69259b422a1a9266e17977f8ec9d939e?s=64" class="profile-image" alt="Home">
            </a>
            <div>
              <a href="http://bramp.net/blog/about-me/">Andrew Brampton</a>

              <div id="social-wrapper">
              
                <a href="https://twitter.com/@TheBramp"><i class="fa fa-twitter-square"></i></a>
              
              
                <a href="https://www.linkedin.com/in/bramp"><i class="fa fa-linkedin-square"></i></a>
              
              
                <a href="https://www.facebook.com/bramp"><i class="fa fa-facebook-square"></i></a>
              
                <a href="https://github.com/bramp"><i class="fa fa-github-square"></i></a>
              
                <a href="http://bramp.net/blog/index.xml"><i class="fa fa-rss-square"></i></a>
             </div>
            </div>
          </div>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="http://bramp.net/blog/about-me/">About Me</a></li>
            <li><a href="http://bramp.net/blog/android-apps/">Android Apps</a></li>
            <li><a href="http://bramp.net/blog/posts/">Articles</a></li>
            <li><a href="http://bramp.net/blog/opensource-projects/">Open Source</a></li>
            <li><a href="http://bramp.net/blog/publications/">Publications</a></li>
          </ul>
        </div>
      </div>
    </div>

     <div class="container main">


  <div id="article">
   <h1>Ordnance Survey Easting/Northing to Lat/Long</h1>
   <p class="meta"><small>&nbsp;<i class="fa fa-calendar-o"></i> 2008-06-04</small> 742 words</p> <hr/>
   <div class="post">
     <p>Recently I had the need to convert Ordnance Survey East/North coordinates to Latitude and Longitude. By using the resources available on the OS site I wrote the following piece of PHP code:</p>

<pre class="prettyprint">&lt;?php
// Converts OS Easting/Northing to Lat/Long
// by bramp
    
function Marc($bf0, $n, $PHI0, $PHI) {
    /*
    Compute meridional arc.
    Input: - 
     ellipsoid semi major axis multiplied by central meridian scale factor (bf0) in meters; 
     n (computed from a, b and f0); 
     lat of false origin (PHI0) 
     initial or final latitude of point (PHI) IN RADIANS.
    */

    $n2 = pow($n, 2);
    $n3 = pow($n, 3);

    $ans  = ((1 + $n + ((5 / 4) * ($n2)) + ((5 / 4) * $n3)) * ($PHI - $PHI0));
    $ans -= (((3 * $n) + (3 * $n2) + ((21 / 8 ) * $n3)) * (sin($PHI - $PHI0)) * (cos($PHI + $PHI0)));
    $ans += ((((15 / 8 ) * $n2) + ((15 / 8 ) * $n3)) * (sin(2 * ($PHI - $PHI0))) * (cos(2 * ($PHI + $PHI0))));
    $ans -= (((35 / 24) * $n3) * (sin(3 * ($PHI - $PHI0))) * (cos(3 * ($PHI + $PHI0))));

    return $bf0 * $ans;
}
    
function initialLat($North, $n0, $afo, $PHI0, $n, $bfo) {
    /*
    Compute initial value for Latitude (PHI) IN RADIANS.
    Input: - _
    northing of point (North) and northing of false origin (n0) in meters; 
    semi major axis multiplied by central meridian scale factor (af0) in meters; 
    latitude of false origin (PHI0) IN RADIANS;
    n (computed from a, b and f0) 
    ellipsoid semi major axis multiplied by central meridian scale factor (bf0) in meters.
    */
    
    //First PHI value (PHI1)
    $PHI1 = (($North - $n0) / $afo) + $PHI0;

    //Calculate M
    $M = Marc($bfo, $n, $PHI0, $PHI1);

    //Calculate new PHI value (PHI2)
    $PHI2 = (($North - $n0 - $M) / $afo) + $PHI1;
    
    //Iterate to get final value for InitialLat
    while ( abs($North - $n0 - $M) &gt; 0.00001 ) {
        $PHI2 = (($North - $n0 - $M) / $afo) + $PHI1;
        $M = Marc($bfo, $n, $PHI0, $PHI2);
        $PHI1 = $PHI2;
    }
    
    return $PHI2;
}

function E_N_to_Lat_Long($East, $North) {
    
    $a  = 6377563.396; // Semi-major axis, a
    $b  = 6356256.910; //Semi-minor axis, b
    $e0 = 400000.000; //True origin Easting, E0 
    $n0 = -100000.000; //True origin Northing, N0   
    $f0 = 0.999601271700; //Central Meridan Scale, F0
    
    $PHI0 = 49.0; // True origin latitude, j0
    $LAM0 = -2.0; // True origin longitude, l0
    
    //Convert angle measures to radians
    $RadPHI0 = $PHI0 * (M_PI / 180);
    $RadLAM0 = $LAM0 * (M_PI / 180);

    //Compute af0, bf0, e squared (e2), n and Et
    $af0 = $a * $f0;
    $bf0 = $b * $f0;
    $e2 = ($af0*$af0 - $bf0*$bf0 ) / ($af0*$af0);
    $n = ($af0 - $bf0) / ($af0 + $bf0);
    $Et = $East - $e0;

    //Compute initial value for latitude (PHI) in radians
    $PHId = InitialLat($North, $n0, $af0, $RadPHI0, $n, $bf0);

    $sinPHId2 = pow(sin($PHId),  2);
    $cosPHId  = pow(cos($PHId), -1);
    
    $tanPHId  = tan($PHId);
    $tanPHId2 = pow($tanPHId, 2);
    $tanPHId4 = pow($tanPHId, 4);
    $tanPHId6 = pow($tanPHId, 6);

    //Compute nu, rho and eta2 using value for PHId
    $nu = $af0 / (sqrt(1 - ($e2 * $sinPHId2)));
    $rho = ($nu * (1 - $e2)) / (1 - $e2 * $sinPHId2);
    $eta2 = ($nu / $rho) - 1;
    
    //Compute Longitude
    $X    = $cosPHId / $nu;
    $XI   = $cosPHId / (   6 * pow($nu, 3)) * (($nu / $rho)         +  2 * $tanPHId2);
    $XII  = $cosPHId / ( 120 * pow($nu, 5)) * (5  + 28 * $tanPHId2  + 24 * $tanPHId4);
    $XIIA = $cosPHId / (5040 * pow($nu, 7)) * (61 + 662 * $tanPHId2 + 1320 * $tanPHId4 + 720 * $tanPHId6);

    $VII  = $tanPHId / (  2 * $rho * $nu);
    $VIII = $tanPHId / ( 24 * $rho * pow($nu, 3)) * ( 5 +  3 * $tanPHId2 + $eta2 - 9 * $eta2 * $tanPHId2 );
    $IX   = $tanPHId / (720 * $rho * pow($nu, 5)) * (61 + 90 * $tanPHId2 + 45 * $tanPHId4 );

    $long = (180 / M_PI) * ($RadLAM0 + ($Et * $X) - pow($Et,3) * $XI + pow($Et,5) * $XII - pow($Et,7) * $XIIA);
    $lat  = (180 / M_PI) * ($PHId - (pow($Et,2) * $VII) + (pow($Et, 4) * $VIII) - (pow($Et, 6) * $IX));
    
    return array($lat, $long);
}
?&gt;;
</pre>

<p>it is used in the following way:</p>

<pre class="prettyprint">$e = 349000;
$n = 461000;

print_r( E_N_to_Lat_Long( $e, $n) );
</pre>

<p>If you find a need to use this please place a link back to my site. thanks</p>

   </div>
 </div>


 <a href="https://twitter.com/share" class="twitter-share-button " data-size="small" data-count="none">Tweet</a>
 <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

 <ul class="pager">
      &nbsp;<li class="previous"><a href="http://bramp.net/blog/2008/06/20/2tb-is-too-much-for-xp/">&larr; 2TB is too much for XP</a></li>
      &nbsp;<li class="next"><a href="http://bramp.net/blog/2008/05/20/characterising-and-exploiting-workloads-of-highly-interactive-video-on-demand/"> Characterising and Exploiting Workloads of Highly Interactive Video-on-Demand &rarr;</a></li>
</ul>

<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost" || window.location.port == 1313) 
        return;

    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = '';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    <footer>
        <p class="text-muted credit">&copy; 2015. All rights reserved. </p>
    </footer>

    </div> 
    </div> 

	
    <script src="http://bramp.net/blog/js/jquery-1.10.2.min.js"></script>
    <script src="http://bramp.net/blog/js/bootstrap.min.js"></script>
  </body>
</html>

