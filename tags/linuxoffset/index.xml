<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Linuxoffset on bramp.net</title>
    <link>http://bramp.net/blog/tags/linuxoffset/</link>
    <description>Recent content in Linuxoffset on bramp.net</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-gb</language>
    <lastBuildDate>Sun, 11 Jan 2009 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://bramp.net/blog/tags/linuxoffset/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>linuxoffsets for FreeBSD</title>
      <link>http://bramp.net/blog/2009/01/11/linuxoffsets-for-freebsd/</link>
      <pubDate>Sun, 11 Jan 2009 00:00:00 +0000</pubDate>
      
      <guid>http://bramp.net/blog/2009/01/11/linuxoffsets-for-freebsd/</guid>
      <description>&lt;p&gt;VMWare 6 and above has this neat debugging functionality where you can attach gdb running on a host, to a guest running inside VMWare. This allows you to debug a running kernel, or on linux running processes.&lt;/p&gt;

&lt;p&gt;However, VMWare seems to have coded a bit of a hack to allow gdb to understand what process/threads are inside the virtual machine. Now this hack involves using something called linuxoffsets, which provides the offset for certain fields in a linux kernel struct.&lt;/p&gt;

&lt;p&gt;So I thought I could abuse these offsets, and hopefully make them work for FreeBSD. The Linux offsets are:&lt;table border=1 cellpadding=3 cellspacing=0&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20style=&#39;height:15.0pt&#39;&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;version&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;mm&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;next_task&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;tasks&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;comm&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;pid&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;thread&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;pgd&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;rsp0/esp0&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;fs&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;threadsize&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;grouplead&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;threadgroup&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;tr height=20 style=&#39;height:15.0pt&#39;&gt; &lt;td height=20 style=&#39;height:15.0pt&#39;&gt;&lt;commsize&gt;&lt;/td&gt;&lt;/p&gt;

&lt;p&gt;&lt;/tr&gt; &lt;/table&gt;&lt;/p&gt;

&lt;p&gt;However, after some time I feel this isn&amp;#8217;t going to be possible. Each value represents a offset into a Linux task_struct struct, however, nothing represents the location of the first task_struct in RAM. I suspect VMWare is figuring out the location via some other means. Since FreeBSD doesn&amp;#8217;t have a task_struct it most likely won&amp;#8217;t be able to find what it needs.&lt;/p&gt;

&lt;p&gt;Regardless I&amp;#8217;ve posted this entry in case someone wants to continue my work. However, not all is lost as my next solution involves playing with gdb-python.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>