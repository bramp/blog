<!DOCTYPE html>
<html lang=en>
<head itemscope itemtype=http://schema.org/WebSite>
<meta charset=utf-8>
<meta content="width=device-width,initial-scale=1" name=viewport>
<link href=https://blog.bramp.net/post/2009/06/01/threadnetperf-v1.0/ rel=canonical itemprop=url />
<title>Threadnetperf v1.0</title>
<meta content="Today I am proud to announce that I&#8217;m releasing a tool I&#8217;ve used privately for well over a year now. It is a multi-threaded network testing tool which gives the user great control over how …" name=description itemprop=description>
<meta content="Andrew Brampton" name=author itemprop=creator>
<meta content="" name=generator />
<link href=https://blog.bramp.net/index.xml rel=alternate type=application/rss+xml title=bramp.net />
<link href=https://blog.bramp.net/index.xml rel=feed type=application/rss+xml title=bramp.net />
<link href=/favicon.ico rel="shortcut icon" type=image/x-icon />
<link href=/images/favicon.png rel=apple-touch-icon-precomposed />
<link href=/images/favicon-57x57.png rel=apple-touch-icon-precomposed sizes=57x57 />
<link href=/images/favicon-72x72.png rel=apple-touch-icon-precomposed sizes=72x72 />
<link href=/images/favicon-76x76.png rel=apple-touch-icon-precomposed sizes=76x76 />
<link href=/images/favicon-114x114.png rel=apple-touch-icon-precomposed sizes=114x114 />
<link href=/images/favicon-120x120.png rel=apple-touch-icon-precomposed sizes=120x120 />
<link href=/images/favicon-144x144.png rel=apple-touch-icon-precomposed sizes=144x144 />
<link href=/images/favicon-152x152.png rel=apple-touch-icon-precomposed sizes=152x152 />
<link href=/images/favicon-180x180.png rel=apple-touch-icon-precomposed sizes=180x180 />
<meta content=#4582EC name=msapplication-TileColor>
<meta content=/images/favicon-144x144.png name=msapplication-TileImage>
<meta content=#4582EC name=theme-color>
<link href=/images/favicon-192x192.png rel=icon sizes=192x192 />
<link href=/css/all.min.css rel=stylesheet>
<link href=https://fonts.gstatic.com rel=preconnect crossorigin>
<link href="https://fonts.googleapis.com/css?family=Raleway:400,700" rel=stylesheet type=text/css>
<link href=https://netdna.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.css rel=stylesheet>
<link href=https://cdn.jsdelivr.net/font-hack/2.010/css/hack.min.css rel=stylesheet>
<meta content=summary name=twitter:card />
<meta content=@TheBramp name=twitter:site />
<meta content=@TheBramp name=twitter:creator />
<meta content=article property=og:type />
<meta content=https://www.facebook.com/bramp property=article:author />
<meta content=2009-06-01T00:00:00&#43;07:00 property=article:published_time />
<meta content=benchmark property=article:tag />
<meta content=FreeBSD property=article:tag />
<meta content=Linux property=article:tag />
<meta content=threadnetperf property=article:tag />
<meta content=windows property=article:tag />
<meta content=https://blog.bramp.net/post/2009/06/01/threadnetperf-v1.0/ property=og:url />
<meta content=bramp.net property=og:site_name />
<meta content="Threadnetperf v1.0" property=og:title />
<meta content="Today I am proud to announce that I&#8217;m releasing a tool I&#8217;ve used privately for well over a year now. It is a multi-threaded network testing tool which gives the user great control over how …" property=og:description />
<meta content=2009-06-01T00:00:00&#43;00:00 property=og:updated_time />
<meta content=en_GB property=og:locale />
<meta content=RXqIC-7spNUYReoHFlubz8Fbqsg1fC1pE6FSgSnCNjQ name=google-site-verification />
</head>
<body itemscope itemtype=Blog>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-136478-5', 'auto');
    ga('require', 'linkid', 'linkid.js');
    ga('send', 'pageview');
</script>
<div id=wrapper>
<div class="navbar navbar-default">
<div class=container>
<div class=navbar-header>
<button class=navbar-toggle data-target=.navbar-collapse data-toggle=collapse type=button>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span>
</button>
<div class=navbar-brand aria-label="About Andrew Brampton">
<a href=/ >
<img alt=Home class=profile-image src=/images/favicon-64x64.png>
</a>
<div itemprop=author itemscope itemtype=https://schema.org/Person>
<a href=/about-me/ itemprop=name>Andrew Brampton</a>
<div id=social-wrapper>
<a href=https://twitter.com/TheBramp aria-label=Twitter><i class="fa fa-twitter-square"></i></a>
<a href=https://www.linkedin.com/in/bramp aria-label=LinkedIn><i class="fa fa-linkedin-square"></i></a>
<a href=https://www.facebook.com/bramp aria-label=Facebook><i class="fa fa-facebook-square"></i></a>
<a href=https://github.com/bramp aria-label=GitHub><i class="fa fa-github-square"></i></a>
<a href=https://feeds.feedburner.com/brampnet aria-label="RSS feed"><i class="fa fa-rss-square"></i></a>
</div>
</div>
</div>
</div>
<div class="collapse navbar-collapse">
<ul class="nav navbar-nav" role=navigation>
<li><a href=/ >Articles</a></li>
<li><a href=/about-me/ >About Me</a></li>
<li><a href=/android-app/ >Android Apps</a></li>
<li><a href=/opensource/ >Open Source</a></li>
<li><a href=/publication/ >Publications</a></li>
</ul>
</div>
</div>
</div>
<div class="container main">
<article id=article itemProp=blogPost itemscope itemtype=http://schema.org/BlogPosting>
<h1 itemprop=headline>Threadnetperf v1.0</h1>
<p class=meta>
<i class="fa fa-calendar-o"></i> <time itemprop=datePublished>2009-06-01</time>
| <a href=https://blog.bramp.net/tags/benchmark/ >benchmark</a>
| <a href=https://blog.bramp.net/tags/freebsd/ >FreeBSD</a>
| <a href=https://blog.bramp.net/tags/linux/ >Linux</a>
| <a href=https://blog.bramp.net/tags/threadnetperf/ >threadnetperf</a>
| <a href=https://blog.bramp.net/tags/windows/ >windows</a>
</p>
<div class=post itemprop=articleBody>
<p>Today I am proud to announce that I&#8217;m releasing a tool I&#8217;ve used privately for well over a year now. It is a multi-threaded network testing tool which gives the user great control over how many connections, threads and processes the tool uses, and which CPU cores the threads/processes are allowed to execute on.</p>
<p>Currently the tool runs on Linux, FreeBSD, and Windows, and has performance as good as (if not better) than other similar tools, such as netperf, iperf, but with the added flexibility. Additionally, Threadnetperf has been completely written from scratch in C, using modern programming techniques and APIs (such as ePoll on Linux) which ensures the program runs as far as possible with minimal overheads.</p>
<p>You can <a href=https://github.com/bramp/threadnetperf>download the source from GitHub</a>, which contains instructions on how to build it.</p>
<p>So that you get an extra idea of it&#8217;s features here is the README.txt</p>
<div class=highlight><pre class=chroma><code class=language-text data-lang=text>****** Threadnetperf ******
A multi-threaded network benchmark tool
 by  Andrew Brampton (2007-2009)
 and Mathew Faulkner (2007-2009)

Threadnetperf is a highly customisable high performance network benchmarking
tool. The key difference from previous tools is that the user is able to control
how many threads threadnetperf uses, as well as which cores these threads are
pinned to. This tool was useful in our research for measuring the effect of
sending or receiving from one core, and having the OS network stack run on
another core. Additionally the tool can be configured to use an unlimited number
of connections, threads or processes, which scale considerably well due to the
use of the epoll API.

Threadnetperf has previously worked on Windows, Linux, and FreeBSD, however, we
do not test it very rigorously so one of these platforms may be broken. All
patches are welcome.

To build on a *nix style system just use the simple &#34;Makefile&#34; by executing the
command &#34;make&#34; or &#34;gmake&#34;. To build on Windows just use the provided
threadnetperf.2008.sln file.

All the commands of Threadnetperf are documented within the application, but a
quick overview is here:

Usage: threadnetperf [options] tests
Usage: threadnetperf -D [options]
       -c level,interval   Confidence level, must be 95 or 99
       -D         Use daemon mode (wait for incoming tests)
       -d time    Set duration to run the test for
       -e         Eat the data (i.e. dirty it)
       -H host    Set the remote host(and port) to connect to
       -h         Display this help
       -i min,max Set the minimum and maximum iterations
       -m [t,p]   What programming model to use, [thread or process]
       -n         Disable Nagle&#39;s algorithm (e.g no delay)
       -p port    Set the port number for the first server thread to use
       -s size    Set the send/recv size
       -T         Timestamp packets, and measure latency (only on *nix)
       -t         Use TCP
       -r         Packets per second rate (default: ~0)
       -u         Use UDP
       -v         Verbose
       -V         Display version only

       tests      Combination of cores and clients
       tests      Core numbers are masks, for example 1 is core 0, 3 is core 0
and core 1
               N{c-s}   N connections
                        c client cores mask
                        s server cores mask

You can run tests locally, or across two machines. Here are some examples:

    threadnetperf -n -s 10000 1{1-1}

Will run a local TCP test, with Nagle&#39;s algorithm disabled, a send size of
10,000, and 1 TCP connection between cores 0 and 0.

    threadnetperf 10{1-1} 10{2-2} 10{4-4}

Will again run a local TCP test, however this time 10 connection from core 0 to
core 0, 10 connections from core 1 to core 1, and 10 connections from core 2 to
core 2

To run across a network just start the threadnetperf daemon on one of the
machines like so:

     threadnetperf -D

and on the other machine execute:

     threadnetperf -H serverIP 1{1-2}

which will conduct a TCP test from the client to the server, with one thread
executing on client&#39;s core 0, and the server&#39;s core 1.

There is no need to give the threadnetperf daemon any options, as the options
configured on the server will be passed over the network. This make running many
tests very easy as the daemon will continue to wait for new tests until it is
told otherwise.

If you find this tool useful, or you have any suggestions for improvements then
please contact us.</code></pre></div>
</div>
</article>
<div class=row>
<div class=col-sm-6>
<div class=addthis_sharing_toolbox></div>
</div>
<div class=col-sm-6>
<div class=btn-toolbar>
<div class=btn-group>
<a href=https://feeds.feedburner.com/brampnet aria-label="RSS feed" class="btn btn-sm btn-soundcloud">
<i class="fa fa-rss-square"></i> Subscribe via RSS</a>
</div>
<div class=btn-group>
<a href=https://twitter.com/TheBramp class="btn btn-sm btn-twitter"><i class="fa fa-twitter"></i> Follow @TheBramp</a>
</div>
</div>
</div>
</div>
<ul class=pager>
&nbsp;<li class=previous><a href=/post/2009/04/07/open-source-government-petition/ >&larr; Open source Government Petition</a></li>
&nbsp;<li class=next><a href=/post/2009/07/10/final-version-of-my-thesis-online/ >Final Version of my Thesis Online &rarr;</a></li>
</ul>
<div id=disqus_thread itemprop=comment itemscope itemtype=Comment></div>
<script type=text/javascript>
var disqus_shortname = 'bramp';
    var disqus_identifier = 'https:\/\/blog.bramp.net\/post\/2009\/06\/01\/threadnetperf-v1.0\/';
    var disqus_title = 'Threadnetperf v1.0';
    var disqus_url = 'https:\/\/blog.bramp.net\/post\/2009\/06\/01\/threadnetperf-v1.0\/';
    (function() {
	    
	    
	    if (window.location.host.lastIndexOf(":1313") >= 0)
	        return;

        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=http://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
<br/>
<footer>
<p class="credit text-muted">&copy; 2018. All rights reserved.</p>
</footer>
</div>
</div>
<script src=/js/all.min.js></script>
<script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-559846a374d7ecaa" async type=text/javascript></script>
</body>
</html>
